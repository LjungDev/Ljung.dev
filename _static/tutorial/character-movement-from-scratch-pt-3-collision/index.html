<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Ljung | Character Movement from Scratch pt 3: Collision</title><meta name="description" content="In this part we will make sure our character can&#x27;t walk through walls."/><meta name="next-head-count" content="4"/><link rel="icon" href="/favicon.ico"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/site.webmanifest"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/14da082a368919fc.css" as="style"/><link rel="stylesheet" href="/_next/static/css/14da082a368919fc.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-2c644d3580cecc35.js" defer=""></script><script src="/_next/static/chunks/framework-9b5d6ec4444c80fa.js" defer=""></script><script src="/_next/static/chunks/main-7c70317c243a4143.js" defer=""></script><script src="/_next/static/chunks/pages/_app-301819447092fb27.js" defer=""></script><script src="/_next/static/chunks/ddc9e94f-4c7cb313852dfa1e.js" defer=""></script><script src="/_next/static/chunks/247-2427dfe63c188f3b.js" defer=""></script><script src="/_next/static/chunks/13-1bb7831376086322.js" defer=""></script><script src="/_next/static/chunks/pages/tutorial/%5Bslug%5D-22eeb0a3910b85b8.js" defer=""></script><script src="/_next/static/FdMC6e8Jf18CHKkiz_cXU/_buildManifest.js" defer=""></script><script src="/_next/static/FdMC6e8Jf18CHKkiz_cXU/_ssgManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Baloo+2&family=Fira+Code&family=Open+Sans:wght@300;400;700&display=swap">@font-face{font-family:'Baloo 2';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/baloo2/v14/wXK0E3kTposypRydzVT08TS3JnAmtdgazaps.woff) format('woff')}@font-face{font-family:'Fira Code';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/firacode/v21/uU9eCBsR6Z2vfE9aq3bL0fxyUs4tcw4W_D1sFVQ.woff) format('woff')}@font-face{font-family:'Open Sans';font-style:normal;font-weight:300;font-stretch:normal;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsiH0C4k.woff) format('woff')}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:normal;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0C4k.woff) format('woff')}@font-face{font-family:'Open Sans';font-style:normal;font-weight:700;font-stretch:normal;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsg-1y4k.woff) format('woff')}@font-face{font-family:'Baloo 2';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/baloo2/v14/wXK0E3kTposypRydzVT08TS3JnAmtdgazZpp_lGP6HcMqzQCjA.woff) format('woff');unicode-range:U+0900-097F,U+1CD0-1CF6,U+1CF8-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FB}@font-face{font-family:'Baloo 2';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/baloo2/v14/wXK0E3kTposypRydzVT08TS3JnAmtdgazZpn_lGP6HcMqzQCjA.woff) format('woff');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Baloo 2';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/baloo2/v14/wXK0E3kTposypRydzVT08TS3JnAmtdgazZpm_lGP6HcMqzQCjA.woff) format('woff');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Baloo 2';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/baloo2/v14/wXK0E3kTposypRydzVT08TS3JnAmtdgazZpo_lGP6HcMqzQ.woff) format('woff');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Fira Code';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/firacode/v21/uU9eCBsR6Z2vfE9aq3bL0fxyUs4tcw4W_D1sJV37MOzlojwUKaJO.woff) format('woff');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Fira Code';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/firacode/v21/uU9eCBsR6Z2vfE9aq3bL0fxyUs4tcw4W_D1sJVT7MOzlojwUKaJO.woff) format('woff');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Fira Code';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/firacode/v21/uU9eCBsR6Z2vfE9aq3bL0fxyUs4tcw4W_D1sJVz7MOzlojwUKaJO.woff) format('woff');unicode-range:U+1F00-1FFF}@font-face{font-family:'Fira Code';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/firacode/v21/uU9eCBsR6Z2vfE9aq3bL0fxyUs4tcw4W_D1sJVP7MOzlojwUKaJO.woff) format('woff');unicode-range:U+0370-03FF}@font-face{font-family:'Fira Code';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/firacode/v21/uU9eCBsR6Z2vfE9aq3bL0fxyUs4tcw4W_D1sJV77MOzlojwUKaJO.woff) format('woff');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Fira Code';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/firacode/v21/uU9eCBsR6Z2vfE9aq3bL0fxyUs4tcw4W_D1sJVD7MOzlojwUKQ.woff) format('woff');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Open Sans';font-style:normal;font-weight:300;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSKmu0SC55K5gw.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Open Sans';font-style:normal;font-weight:300;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSumu0SC55K5gw.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Open Sans';font-style:normal;font-weight:300;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSOmu0SC55K5gw.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Open Sans';font-style:normal;font-weight:300;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSymu0SC55K5gw.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Open Sans';font-style:normal;font-weight:300;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTS2mu0SC55K5gw.woff2) format('woff2');unicode-range:U+0590-05FF,U+200C-2010,U+20AA,U+25CC,U+FB1D-FB4F}@font-face{font-family:'Open Sans';font-style:normal;font-weight:300;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSCmu0SC55K5gw.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Open Sans';font-style:normal;font-weight:300;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSGmu0SC55K5gw.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Open Sans';font-style:normal;font-weight:300;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTS-mu0SC55I.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSKmu0SC55K5gw.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSumu0SC55K5gw.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSOmu0SC55K5gw.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSymu0SC55K5gw.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTS2mu0SC55K5gw.woff2) format('woff2');unicode-range:U+0590-05FF,U+200C-2010,U+20AA,U+25CC,U+FB1D-FB4F}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSCmu0SC55K5gw.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSGmu0SC55K5gw.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTS-mu0SC55I.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Open Sans';font-style:normal;font-weight:700;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSKmu0SC55K5gw.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Open Sans';font-style:normal;font-weight:700;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSumu0SC55K5gw.woff2) format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Open Sans';font-style:normal;font-weight:700;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSOmu0SC55K5gw.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Open Sans';font-style:normal;font-weight:700;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSymu0SC55K5gw.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Open Sans';font-style:normal;font-weight:700;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTS2mu0SC55K5gw.woff2) format('woff2');unicode-range:U+0590-05FF,U+200C-2010,U+20AA,U+25CC,U+FB1D-FB4F}@font-face{font-family:'Open Sans';font-style:normal;font-weight:700;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSCmu0SC55K5gw.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Open Sans';font-style:normal;font-weight:700;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSGmu0SC55K5gw.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Open Sans';font-style:normal;font-weight:700;font-stretch:100%;font-display:swap;src:url(https://fonts.gstatic.com/s/opensans/v34/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTS-mu0SC55I.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-M8H57QK" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__next"><div class="flex flex-col min-h-screen"><div class="flex flex-col items-center grow pt-12 bg-snow-storm-2 dark:bg-polar-night-0"><div class="flex items-center gap-2"><div class="flex items-center gap-2 hover:cursor-pointer hover:opacity-75"><div class="relative w-14 h-24"><span style="box-sizing:border-box;display:block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:absolute;top:0;left:0;bottom:0;right:0"><img alt="Logo" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="fill" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%;object-fit:contain"/><noscript><img alt="Logo" src="/logo.svg" decoding="async" data-nimg="fill" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%;object-fit:contain" loading="lazy"/></noscript></span></div><div class=" flex flex-col items-center gap-1"><div class="relative"><h1 class="text-6xl font-display text-polar-night-0 dark:text-snow-storm-2">Ljung</h1><span class="absolute right-0 bottom-0.5 w-0"><span class="text-base font-display opacity-50 text-polar-night-0 dark:text-snow-storm-2"></span></span></div></div><span class="text-base font-display opacity-50 text-polar-night-0 dark:text-snow-storm-2">.dev</span></div><div class="flex gap-1 items-center font-body text-base"><a class="font-bold text-polar-night-0 dark:text-snow-storm-2" href="/tutorials/">Tutorials</a></div></div><div class="max-w-xl w-full flex flex-col gap-12 items-center mb-12"><div class="h-[1px] w-full opacity-10 bg-polar-night-0 dark:bg-snow-storm-2"></div><div class="flex flex-col gap-5 max-w-[min(100%,512px)] m-3 p-3 text-polar-night-0 dark:text-snow-storm-2 text-base font-body"><div class="flex"><div class="grow text-left"><a class="text-frost-3 dark:text-frost-1 hover:opacity-50 active:opacity-75" href="/tutorial/character-movement-from-scratch-pt-2-basic-movement/">« <!-- -->pt 2: Basic Movement</a></div><div class="grow text-right"><a class="text-frost-3 dark:text-frost-1 hover:opacity-50 active:opacity-75" href="/tutorial/character-movement-from-scratch-pt-4-gravity/">pt 4: Gravity<!-- --> »</a></div></div><div><blockquote class="bg-snow-storm-0 dark:bg-polar-night-1 border-l-4 border-l-polar-night-0 dark:border-l-snow-storm-0 px-4 py-2 my-2"><p class="py-2 false">A project using this tutorial series is <a target="_blank" class="text-frost-3 dark:text-frost-1 hover:opacity-50 active:opacity-75" href="https://github.com/LjungDev/Cactus">tracked on GitHub</a>. The revision after this part is <a target="_blank" class="text-frost-3 dark:text-frost-1 hover:opacity-50 active:opacity-75" href="https://github.com/LjungDev/Cactus/commit/39e74196af789d7da1b418fd0c9fc081720a554e">39e7419</a>.</p></blockquote><p class="py-2 false">Hej!</p><p class="py-2 false">In this part we will look at basic collision handling related to movement and make sure that our character doesn&#x27;t go through walls anymore.</p><p class="py-2 false">It is actually fairly easy to implement as Unreal does all the heavy lifting of doing low-level collision checking, however we need to make sure that &quot;colliding&quot; means to prevent walking through walls, and also try to slide along them instead. Luckily there is a function built into <code class="px-1 rounded-sm bg-snow-storm-0 dark:bg-polar-night-2">UMovementComponent</code> called <code class="px-1 rounded-sm bg-snow-storm-0 dark:bg-polar-night-2">SlideALongSurface</code> that helps with that.</p><p class="py-2 false">The steps we need to take are:</p><ol class="list-decimal list-inside"><li class="my-2 pl-2"><p class="py-2 inline">Set character collision profile to <code class="px-1 rounded-sm bg-snow-storm-0 dark:bg-polar-night-2">Pawn</code>.</p></li><li class="my-2 pl-2"><p class="py-2 inline">Change <code class="px-1 rounded-sm bg-snow-storm-0 dark:bg-polar-night-2">MoveUpdatedComponent</code> to <code class="px-1 rounded-sm bg-snow-storm-0 dark:bg-polar-night-2">SafeMoveUpdatedComponent.</code></p></li><li class="my-2 pl-2"><p class="py-2 inline">Check for any valid hits after moving.</p></li><li class="my-2 pl-2"><p class="py-2 inline">Call HandleImpact and SlideAlongSurface accordingly.</p></li></ol><h1 class="font-display text-4xl pt-6">Collision Profile</h1><p class="py-2 false">First things first we need to set the collision profile of our character to <code class="px-1 rounded-sm bg-snow-storm-0 dark:bg-polar-night-2">Pawn</code> (or something else that might be appropriate for your project). By default it is set to <code class="px-1 rounded-sm bg-snow-storm-0 dark:bg-polar-night-2">OverlapAllDynamic</code> which won&#x27;t trigger any blocking hits. In your equivalent of <code class="px-1 rounded-sm bg-snow-storm-0 dark:bg-polar-night-2">BP_CactusPlayerPawn</code>, on the capsule component set the collision preset:</p><div class="flex justify-center cursor-pointer"><div style="overflow:hidden;position:relative;width:100%;max-width:425px"><img style="display:block;width:100%" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MjUiIGhlaWdodD0iMzQwIj48L3N2Zz4=" aria-hidden="true" alt=""/><img role="presentation" aria-hidden="true" alt="" src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoHBwgHBhQPCAgLChUVFxgNGBQVDhkeFhgTFxUZGBYWFyEbHzckHx0oHRUiJTUlKC0vOjIyGSI4PTcwPCsxMi8BCgsLDg0OHRAQHDsgIhwvLy8vNTs7Oy8wLzwvNS8vLy8vLzUvLzYvOy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL//AABEIABQAGAMBIgACEQEDEQH/xAAbAAACAQUAAAAAAAAAAAAAAAAABAUBAgMGB//EACIQAAIBAgUFAAAAAAAAAAAAAAABAwIEBRMhIjEGERIyUv/EABYBAQEBAAAAAAAAAAAAAAAAAAMAAf/EABoRAAIDAQEAAAAAAAAAAAAAAAACASFBMRH/2gAMAwEAAhEDEQA/AOb1YnHC9WOWuLRyLaxSrAXPVo2iVsOmMunhsyVsyOGGfFI41ufYBq76ZzVqmA6ovllBLWcdDr4NgtYqPD1KgHpYXyRUfIAAhH//2Q==" style="opacity:1;transition:opacity 500ms;position:absolute;left:0;top:0;width:100%"/><noscript><picture><source srcSet="https://www.datocms-assets.com/77616/1661954484-fpmfs-pt3-collision-profile.png?auto=format&amp;dpr=0.25&amp;fm=webp&amp;max-w=600 106w,https://www.datocms-assets.com/77616/1661954484-fpmfs-pt3-collision-profile.png?auto=format&amp;dpr=0.5&amp;fm=webp&amp;max-w=600 212w,https://www.datocms-assets.com/77616/1661954484-fpmfs-pt3-collision-profile.png?auto=format&amp;dpr=0.75&amp;fm=webp&amp;max-w=600 318w,https://www.datocms-assets.com/77616/1661954484-fpmfs-pt3-collision-profile.png?auto=format&amp;fm=webp&amp;max-w=600 425w" sizes="(max-width: 425px) 100vw, 425px" type="image/webp"/><source srcSet="https://www.datocms-assets.com/77616/1661954484-fpmfs-pt3-collision-profile.png?auto=format&amp;dpr=0.25&amp;max-w=600 106w,https://www.datocms-assets.com/77616/1661954484-fpmfs-pt3-collision-profile.png?auto=format&amp;dpr=0.5&amp;max-w=600 212w,https://www.datocms-assets.com/77616/1661954484-fpmfs-pt3-collision-profile.png?auto=format&amp;dpr=0.75&amp;max-w=600 318w,https://www.datocms-assets.com/77616/1661954484-fpmfs-pt3-collision-profile.png?auto=format&amp;max-w=600 425w" sizes="(max-width: 425px) 100vw, 425px"/><img src="https://www.datocms-assets.com/77616/1661954484-fpmfs-pt3-collision-profile.png?auto=format&amp;max-w=600" alt="" style="position:absolute;left:0;top:0;width:100%;height:100%" loading="lazy"/></picture></noscript></div></div><h1 class="font-display text-4xl pt-6">Movement Code</h1><h2 class="font-display text-3xl pt-5">SafeMoveUpdatedComponent</h2><p class="py-2 false">First we are going to change <code class="px-1 rounded-sm bg-snow-storm-0 dark:bg-polar-night-2">MoveUpdatedComponent</code> to <code class="px-1 rounded-sm bg-snow-storm-0 dark:bg-polar-night-2">SafeMoveUpdatedComponent</code>. This is strictly not necessary for our code to work, however the difference is that the safe version automatically resolves initial penetrations, if we somehow start or end-up inside a wall. To facilitate this the safe version requires an additional <code class="px-1 rounded-sm bg-snow-storm-0 dark:bg-polar-night-2">FHitResult</code> parameter (optional on the non-safe variant). </p><p class="py-2 false">Replace our call to <code class="px-1 rounded-sm bg-snow-storm-0 dark:bg-polar-night-2">MoveUpdatedComponent(...)</code> with:</p><div class="border-snow-storm-0 dark:border-polar-night-1 border-2 rounded flex flex-col gap-1 my-2"><span class="text-polar-night-3 mx-2">cpp</span><pre style="color:#f8f8f2;background:#2E3440;font-family:&quot;Fira Code&quot;, Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto;border-radius:0"><code class="language-cpp" style="color:#f8f8f2;background:none;font-family:&quot;Fira Code&quot;, Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">1</span><span>FHitResult Hit</span><span class="token" style="color:#81A1C1">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">2</span><span></span><span class="token" style="color:#88C0D0">SafeMoveUpdatedComponent</span><span class="token" style="color:#81A1C1">(</span><span>Velocity</span><span class="token" style="color:#81A1C1">,</span><span> Rotation</span><span class="token" style="color:#81A1C1">,</span><span> </span><span class="token" style="color:#81A1C1">true</span><span class="token" style="color:#81A1C1">,</span><span> Hit</span><span class="token" style="color:#81A1C1">)</span><span class="token" style="color:#81A1C1">;</span></code></pre></div><p class="py-2 false">Notice that we also set the <code class="px-1 rounded-sm bg-snow-storm-0 dark:bg-polar-night-2">bSweep</code> parameter to <code class="px-1 rounded-sm bg-snow-storm-0 dark:bg-polar-night-2">true</code>. This is what enables collision checking internally.</p><h1 class="font-display text-4xl pt-6">SlideAlongSurface</h1><p class="py-2 false">If you hit play now and try moving around you will notice that we won&#x27;t go through walls anymore. However, unless we are moving directly away from a wall we instead stick to it!</p><video style="height:100%;max-width:100%" metadata="[object Object]" controls="" muted="" loop=""></video><p class="py-2 false">This is because we have yet to handle what happens when we collide. <code class="px-1 rounded-sm bg-snow-storm-0 dark:bg-polar-night-2">SafeMoveUpdatedComponent</code> automatically stops the movement but we need to slide along the surface as well. Luckily it&#x27;s very simple; we only need to add the following snippet directly after the movement call:</p><div class="border-snow-storm-0 dark:border-polar-night-1 border-2 rounded flex flex-col gap-1 my-2"><span class="text-polar-night-3 mx-2">cpp</span><pre style="color:#f8f8f2;background:#2E3440;font-family:&quot;Fira Code&quot;, Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto;border-radius:0"><code class="language-cpp" style="color:#f8f8f2;background:none;font-family:&quot;Fira Code&quot;, Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">1</span><span class="token" style="color:#81A1C1">if</span><span> </span><span class="token" style="color:#81A1C1">(</span><span>Hit</span><span class="token" style="color:#81A1C1">.</span><span class="token" style="color:#88C0D0">IsValidBlockingHit</span><span class="token" style="color:#81A1C1">(</span><span class="token" style="color:#81A1C1">)</span><span class="token" style="color:#81A1C1">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">2</span><span></span><span class="token" style="color:#81A1C1">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">3</span><span>   </span><span class="token" style="color:#88C0D0">HandleImpact</span><span class="token" style="color:#81A1C1">(</span><span>Hit</span><span class="token" style="color:#81A1C1">,</span><span> DeltaTime</span><span class="token" style="color:#81A1C1">,</span><span> Velocity</span><span class="token" style="color:#81A1C1">)</span><span class="token" style="color:#81A1C1">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">4</span><span>   </span><span class="token" style="color:#88C0D0">SlideAlongSurface</span><span class="token" style="color:#81A1C1">(</span><span>Velocity</span><span class="token" style="color:#81A1C1">,</span><span> </span><span class="token" style="color:#B48EAD">1.0f</span><span> </span><span class="token" style="color:#81A1C1">-</span><span> Hit</span><span class="token" style="color:#81A1C1">.</span><span>Time</span><span class="token" style="color:#81A1C1">,</span><span> Hit</span><span class="token" style="color:#81A1C1">.</span><span>Normal</span><span class="token" style="color:#81A1C1">,</span><span> Hit</span><span class="token" style="color:#81A1C1">,</span><span> </span><span class="token" style="color:#81A1C1">true</span><span class="token" style="color:#81A1C1">)</span><span class="token" style="color:#81A1C1">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">5</span><span></span><span class="token" style="color:#81A1C1">}</span></code></pre></div><p class="py-2 false"><code class="px-1 rounded-sm bg-snow-storm-0 dark:bg-polar-night-2">HandleImpact</code> is a helper to catch and propagate an impact throughout the movement component, however the base implementation is empty so in our case it is not strictly needed, but it&#x27;s still good practice to include.</p><p class="py-2 false"><code class="px-1 rounded-sm bg-snow-storm-0 dark:bg-polar-night-2">SlideAlongSurface</code> is the main part and it simply computes and moves the component along a projected vector based on the normal (angle) and other parameters we give it. Internally it calls <code class="px-1 rounded-sm bg-snow-storm-0 dark:bg-polar-night-2">SafeMoveUpdatedComponent</code> and <code class="px-1 rounded-sm bg-snow-storm-0 dark:bg-polar-night-2">HandleImpact</code> like we&#x27;ve done. </p><h1 class="font-display text-4xl pt-6">Results</h1><p class="py-2 false">We should now correctly slide along any walls:</p><video style="height:100%;max-width:100%" metadata="[object Object]" controls="" muted="" loop=""></video><p class="py-2 false">Interestingly, since <code class="px-1 rounded-sm bg-snow-storm-0 dark:bg-polar-night-2">SlideAlongSurface</code> is not restricted to the horizontal plane we actually slide up slopes as well: </p><video style="height:100%;max-width:100%" metadata="[object Object]" controls="" muted="" loop=""></video><p class="py-2 false">However we don&#x27;t slide down as no collision is happening and we aren&#x27;t applying gravity (which is what we will take a look at in the next part!).</p><p class="py-2 false">Our full <code class="px-1 rounded-sm bg-snow-storm-0 dark:bg-polar-night-2">TickComponent</code> function now looks like this:</p><div class="border-snow-storm-0 dark:border-polar-night-1 border-2 rounded flex flex-col gap-1 my-2"><span class="text-polar-night-3 mx-2">cpp</span><pre style="color:#f8f8f2;background:#2E3440;font-family:&quot;Fira Code&quot;, Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto;border-radius:0"><code class="language-cpp" style="color:#f8f8f2;background:none;font-family:&quot;Fira Code&quot;, Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">1</span><span class="token" style="color:#81A1C1">void</span><span> </span><span class="token" style="color:#88C0D0">USimpleMovementComponent</span><span class="token double-colon" style="color:#81A1C1">::</span><span class="token" style="color:#88C0D0">TickComponent</span><span class="token" style="color:#81A1C1">(</span><span class="token" style="color:#81A1C1">float</span><span> DeltaTime</span><span class="token" style="color:#81A1C1">,</span><span> ELevelTick TickType</span><span class="token" style="color:#81A1C1">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">2</span><span>                                             FActorComponentTickFunction</span><span class="token" style="color:#81A1C1">*</span><span> ThisTickFunction</span><span class="token" style="color:#81A1C1">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">3</span><span></span><span class="token" style="color:#81A1C1">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">4</span><span>  </span><span class="token" style="color:#88C0D0">Super</span><span class="token double-colon" style="color:#81A1C1">::</span><span class="token" style="color:#88C0D0">TickComponent</span><span class="token" style="color:#81A1C1">(</span><span>DeltaTime</span><span class="token" style="color:#81A1C1">,</span><span> TickType</span><span class="token" style="color:#81A1C1">,</span><span> ThisTickFunction</span><span class="token" style="color:#81A1C1">)</span><span class="token" style="color:#81A1C1">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">5</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">6</span><span>  </span><span class="token" style="color:#81A1C1">if</span><span> </span><span class="token" style="color:#81A1C1">(</span><span class="token" style="color:#88C0D0">ShouldSkipUpdate</span><span class="token" style="color:#81A1C1">(</span><span>DeltaTime</span><span class="token" style="color:#81A1C1">)</span><span class="token" style="color:#81A1C1">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">7</span><span>  </span><span class="token" style="color:#81A1C1">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">8</span><span>    </span><span class="token" style="color:#81A1C1">return</span><span class="token" style="color:#81A1C1">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">9</span><span>  </span><span class="token" style="color:#81A1C1">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">10</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">11</span><span>  </span><span class="token" style="color:#81A1C1">if</span><span> </span><span class="token" style="color:#81A1C1">(</span><span class="token" style="color:#81A1C1">!</span><span>PawnOwner </span><span class="token" style="color:#81A1C1">||</span><span> </span><span class="token" style="color:#81A1C1">!</span><span>UpdatedComponent</span><span class="token" style="color:#81A1C1">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">12</span><span>  </span><span class="token" style="color:#81A1C1">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">13</span><span>    </span><span class="token" style="color:#81A1C1">return</span><span class="token" style="color:#81A1C1">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">14</span><span>  </span><span class="token" style="color:#81A1C1">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">15</span>  
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">16</span><span>  </span><span class="token" style="color:#636f88">// Reset velocity</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">17</span><span>  Velocity</span><span class="token" style="color:#81A1C1">.</span><span>X </span><span class="token" style="color:#81A1C1">=</span><span> </span><span class="token" style="color:#B48EAD">0</span><span class="token" style="color:#81A1C1">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">18</span><span>  Velocity</span><span class="token" style="color:#81A1C1">.</span><span>Y </span><span class="token" style="color:#81A1C1">=</span><span> </span><span class="token" style="color:#B48EAD">0</span><span class="token" style="color:#81A1C1">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">19</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">20</span><span>  </span><span class="token" style="color:#636f88">// Calculate force</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">21</span><span>  </span><span class="token" style="color:#81A1C1">const</span><span> FVector</span><span class="token" style="color:#81A1C1">&amp;</span><span> Input </span><span class="token" style="color:#81A1C1">=</span><span> </span><span class="token" style="color:#88C0D0">ConsumeInputVector</span><span class="token" style="color:#81A1C1">(</span><span class="token" style="color:#81A1C1">)</span><span class="token" style="color:#81A1C1">.</span><span class="token" style="color:#88C0D0">GetClampedToMaxSize2D</span><span class="token" style="color:#81A1C1">(</span><span class="token" style="color:#B48EAD">1.0f</span><span class="token" style="color:#81A1C1">)</span><span class="token" style="color:#81A1C1">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">22</span><span>  </span><span class="token" style="color:#81A1C1">const</span><span> FVector DesiredInputForce </span><span class="token" style="color:#81A1C1">=</span><span> Input </span><span class="token" style="color:#81A1C1">*</span><span> MoveSpeed</span><span class="token" style="color:#81A1C1">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">23</span><span>  Velocity </span><span class="token" style="color:#81A1C1">+=</span><span> DesiredInputForce</span><span class="token" style="color:#81A1C1">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">24</span><span>  </span><span class="token" style="color:#81A1C1">const</span><span> FVector MovementDelta </span><span class="token" style="color:#81A1C1">=</span><span> Velocity </span><span class="token" style="color:#81A1C1">*</span><span> DeltaTime</span><span class="token" style="color:#81A1C1">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">25</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">26</span><span>  </span><span class="token" style="color:#636f88">// Move</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">27</span><span>  </span><span class="token" style="color:#81A1C1">const</span><span> FRotator</span><span class="token" style="color:#81A1C1">&amp;</span><span> Rotation </span><span class="token" style="color:#81A1C1">=</span><span> UpdatedComponent</span><span class="token" style="color:#81A1C1">-&gt;</span><span class="token" style="color:#88C0D0">GetComponentRotation</span><span class="token" style="color:#81A1C1">(</span><span class="token" style="color:#81A1C1">)</span><span class="token" style="color:#81A1C1">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">28</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">29</span><span>  FHitResult Hit</span><span class="token" style="color:#81A1C1">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">30</span><span>  </span><span class="token" style="color:#88C0D0">SafeMoveUpdatedComponent</span><span class="token" style="color:#81A1C1">(</span><span>MovementDelta</span><span class="token" style="color:#81A1C1">,</span><span> Rotation</span><span class="token" style="color:#81A1C1">,</span><span> </span><span class="token" style="color:#81A1C1">true</span><span class="token" style="color:#81A1C1">,</span><span> Hit</span><span class="token" style="color:#81A1C1">)</span><span class="token" style="color:#81A1C1">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">31</span>  
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">32</span><span>  </span><span class="token" style="color:#81A1C1">if</span><span> </span><span class="token" style="color:#81A1C1">(</span><span>Hit</span><span class="token" style="color:#81A1C1">.</span><span class="token" style="color:#88C0D0">IsValidBlockingHit</span><span class="token" style="color:#81A1C1">(</span><span class="token" style="color:#81A1C1">)</span><span class="token" style="color:#81A1C1">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">33</span><span>  </span><span class="token" style="color:#81A1C1">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">34</span><span>    </span><span class="token" style="color:#88C0D0">HandleImpact</span><span class="token" style="color:#81A1C1">(</span><span>Hit</span><span class="token" style="color:#81A1C1">,</span><span> DeltaTime</span><span class="token" style="color:#81A1C1">,</span><span> MovementDelta</span><span class="token" style="color:#81A1C1">)</span><span class="token" style="color:#81A1C1">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">35</span><span>    </span><span class="token" style="color:#88C0D0">SlideAlongSurface</span><span class="token" style="color:#81A1C1">(</span><span>MovementDelta</span><span class="token" style="color:#81A1C1">,</span><span> </span><span class="token" style="color:#B48EAD">1.0f</span><span> </span><span class="token" style="color:#81A1C1">-</span><span> Hit</span><span class="token" style="color:#81A1C1">.</span><span>Time</span><span class="token" style="color:#81A1C1">,</span><span> Hit</span><span class="token" style="color:#81A1C1">.</span><span>Normal</span><span class="token" style="color:#81A1C1">,</span><span> Hit</span><span class="token" style="color:#81A1C1">,</span><span> </span><span class="token" style="color:#81A1C1">true</span><span class="token" style="color:#81A1C1">)</span><span class="token" style="color:#81A1C1">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">36</span><span>  </span><span class="token" style="color:#81A1C1">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">37</span>  
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">38</span><span>  </span><span class="token" style="color:#88C0D0">UpdateComponentVelocity</span><span class="token" style="color:#81A1C1">(</span><span class="token" style="color:#81A1C1">)</span><span class="token" style="color:#81A1C1">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#636f88">39</span><span></span><span class="token" style="color:#81A1C1">}</span></code></pre></div></div><div class="flex"><div class="grow text-left"><a class="text-frost-3 dark:text-frost-1 hover:opacity-50 active:opacity-75" href="/tutorial/character-movement-from-scratch-pt-2-basic-movement/">« <!-- -->pt 2: Basic Movement</a></div><div class="grow text-right"><a class="text-frost-3 dark:text-frost-1 hover:opacity-50 active:opacity-75" href="/tutorial/character-movement-from-scratch-pt-4-gravity/">pt 4: Gravity<!-- --> »</a></div></div></div><div class="h-[1px] w-full opacity-10 bg-polar-night-0 dark:bg-snow-storm-2"></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"siteMetainfo":{"headerTitle":"Ljung","headerSubtitle":".dev","pageTitlePrefix":"Ljung | "},"_site":{"globalSeo":{"siteName":"Ljung","fallbackSeo":{"title":"Ljung | Game Dev","description":"Indie Game Developer from Sweden 🎮"}}},"post":{"title":"Character Movement from Scratch pt 3: Collision","description":"In this part we will make sure our character can't walk through walls.","seriesPrevious":{"slug":"character-movement-from-scratch-pt-2-basic-movement","seriesTitle":"pt 2: Basic Movement"},"seriesNext":{"slug":"character-movement-from-scratch-pt-4-gravity","seriesTitle":"pt 4: Gravity"},"content":{"value":{"schema":"dast","document":{"type":"root","children":[{"type":"blockquote","children":[{"type":"paragraph","children":[{"type":"span","value":"A project using this tutorial series is "},{"url":"https://github.com/LjungDev/Cactus","meta":[{"id":"target","value":"_blank"}],"type":"link","children":[{"type":"span","value":"tracked on GitHub"}]},{"type":"span","value":". The revision after this part is "},{"url":"https://github.com/LjungDev/Cactus/commit/39e74196af789d7da1b418fd0c9fc081720a554e","meta":[{"id":"target","value":"_blank"}],"type":"link","children":[{"type":"span","value":"39e7419"}]},{"type":"span","value":"."}]}]},{"type":"paragraph","children":[{"type":"span","value":"Hej!"}]},{"type":"paragraph","children":[{"type":"span","value":"In this part we will look at basic collision handling related to movement and make sure that our character doesn't go through walls anymore."}]},{"type":"paragraph","children":[{"type":"span","value":"It is actually fairly easy to implement as Unreal does all the heavy lifting of doing low-level collision checking, however we need to make sure that \"colliding\" means to prevent walking through walls, and also try to slide along them instead. Luckily there is a function built into "},{"type":"span","marks":["code"],"value":"UMovementComponent"},{"type":"span","value":" called "},{"type":"span","marks":["code"],"value":"SlideALongSurface"},{"type":"span","value":" that helps with that."}]},{"type":"paragraph","children":[{"type":"span","value":"The steps we need to take are:"}]},{"type":"list","style":"numbered","children":[{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"Set character collision profile to "},{"type":"span","marks":["code"],"value":"Pawn"},{"type":"span","value":"."}]}]},{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"Change "},{"type":"span","marks":["code"],"value":"MoveUpdatedComponent"},{"type":"span","value":" to "},{"type":"span","marks":["code"],"value":"SafeMoveUpdatedComponent."}]}]},{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"Check for any valid hits after moving."}]}]},{"type":"listItem","children":[{"type":"paragraph","children":[{"type":"span","value":"Call HandleImpact and SlideAlongSurface accordingly."}]}]}]},{"type":"heading","level":1,"children":[{"type":"span","value":"Collision Profile"}]},{"type":"paragraph","children":[{"type":"span","value":"First things first we need to set the collision profile of our character to "},{"type":"span","marks":["code"],"value":"Pawn"},{"type":"span","value":" (or something else that might be appropriate for your project). By default it is set to "},{"type":"span","marks":["code"],"value":"OverlapAllDynamic"},{"type":"span","value":" which won't trigger any blocking hits. In your equivalent of "},{"type":"span","marks":["code"],"value":"BP_CactusPlayerPawn"},{"type":"span","value":", on the capsule component set the collision preset:"}]},{"item":"55423363","type":"block"},{"type":"heading","level":1,"children":[{"type":"span","value":"Movement Code"}]},{"type":"heading","level":2,"children":[{"type":"span","value":"SafeMoveUpdatedComponent"}]},{"type":"paragraph","children":[{"type":"span","value":"First we are going to change "},{"type":"span","marks":["code"],"value":"MoveUpdatedComponent"},{"type":"span","value":" to "},{"type":"span","marks":["code"],"value":"SafeMoveUpdatedComponent"},{"type":"span","value":". This is strictly not necessary for our code to work, however the difference is that the safe version automatically resolves initial penetrations, if we somehow start or end-up inside a wall. To facilitate this the safe version requires an additional "},{"type":"span","marks":["code"],"value":"FHitResult"},{"type":"span","value":" parameter (optional on the non-safe variant). "}]},{"type":"paragraph","children":[{"type":"span","value":"Replace our call to "},{"type":"span","marks":["code"],"value":"MoveUpdatedComponent(...)"},{"type":"span","value":" with:"}]},{"code":"FHitResult Hit;\nSafeMoveUpdatedComponent(Velocity, Rotation, true, Hit);","type":"code","language":"cpp"},{"type":"paragraph","children":[{"type":"span","value":"Notice that we also set the "},{"type":"span","marks":["code"],"value":"bSweep"},{"type":"span","value":" parameter to "},{"type":"span","marks":["code"],"value":"true"},{"type":"span","value":". This is what enables collision checking internally."}]},{"type":"heading","level":1,"children":[{"type":"span","value":"SlideAlongSurface"}]},{"type":"paragraph","children":[{"type":"span","value":"If you hit play now and try moving around you will notice that we won't go through walls anymore. However, unless we are moving directly away from a wall we instead stick to it!"}]},{"item":"55423364","type":"block"},{"type":"paragraph","children":[{"type":"span","value":"This is because we have yet to handle what happens when we collide. "},{"type":"span","marks":["code"],"value":"SafeMoveUpdatedComponent"},{"type":"span","value":" automatically stops the movement but we need to slide along the surface as well. Luckily it's very simple; we only need to add the following snippet directly after the movement call:"}]},{"code":"if (Hit.IsValidBlockingHit())\n{\n   HandleImpact(Hit, DeltaTime, Velocity);\n   SlideAlongSurface(Velocity, 1.0f - Hit.Time, Hit.Normal, Hit, true);\n}","type":"code","language":"cpp"},{"type":"paragraph","children":[{"type":"span","marks":["code"],"value":"HandleImpact"},{"type":"span","value":" is a helper to catch and propagate an impact throughout the movement component, however the base implementation is empty so in our case it is not strictly needed, but it's still good practice to include."}]},{"type":"paragraph","children":[{"type":"span","marks":["code"],"value":"SlideAlongSurface"},{"type":"span","value":" is the main part and it simply computes and moves the component along a projected vector based on the normal (angle) and other parameters we give it. Internally it calls "},{"type":"span","marks":["code"],"value":"SafeMoveUpdatedComponent"},{"type":"span","value":" and "},{"type":"span","marks":["code"],"value":"HandleImpact"},{"type":"span","value":" like we've done. "}]},{"type":"heading","level":1,"children":[{"type":"span","value":"Results"}]},{"type":"paragraph","children":[{"type":"span","value":"We should now correctly slide along any walls:"}]},{"item":"55423365","type":"block"},{"type":"paragraph","children":[{"type":"span","value":"Interestingly, since "},{"type":"span","marks":["code"],"value":"SlideAlongSurface"},{"type":"span","value":" is not restricted to the horizontal plane we actually slide up slopes as well: "}]},{"item":"55423366","type":"block"},{"type":"paragraph","children":[{"type":"span","value":"However we don't slide down as no collision is happening and we aren't applying gravity (which is what we will take a look at in the next part!)."}]},{"type":"paragraph","children":[{"type":"span","value":"Our full "},{"type":"span","marks":["code"],"value":"TickComponent"},{"type":"span","value":" function now looks like this:"}]},{"code":"void USimpleMovementComponent::TickComponent(float DeltaTime, ELevelTick TickType,\n                                             FActorComponentTickFunction* ThisTickFunction)\n{\n  Super::TickComponent(DeltaTime, TickType, ThisTickFunction);\n\n  if (ShouldSkipUpdate(DeltaTime))\n  {\n    return;\n  }\n\n  if (!PawnOwner || !UpdatedComponent)\n  {\n    return;\n  }\n  \n  // Reset velocity\n  Velocity.X = 0;\n  Velocity.Y = 0;\n\n  // Calculate force\n  const FVector\u0026 Input = ConsumeInputVector().GetClampedToMaxSize2D(1.0f);\n  const FVector DesiredInputForce = Input * MoveSpeed;\n  Velocity += DesiredInputForce;\n  const FVector MovementDelta = Velocity * DeltaTime;\n\n  // Move\n  const FRotator\u0026 Rotation = UpdatedComponent-\u003eGetComponentRotation();\n\n  FHitResult Hit;\n  SafeMoveUpdatedComponent(MovementDelta, Rotation, true, Hit);\n  \n  if (Hit.IsValidBlockingHit())\n  {\n    HandleImpact(Hit, DeltaTime, MovementDelta);\n    SlideAlongSurface(MovementDelta, 1.0f - Hit.Time, Hit.Normal, Hit, true);\n  }\n  \n  UpdateComponentVelocity();\n}","type":"code","language":"cpp"}]}},"blocks":[{"__typename":"ImageRecord","id":"55423363","image":{"responsiveImage":{"base64":"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoHBwgHBhQPCAgLChUVFxgNGBQVDhkeFhgTFxUZGBYWFyEbHzckHx0oHRUiJTUlKC0vOjIyGSI4PTcwPCsxMi8BCgsLDg0OHRAQHDsgIhwvLy8vNTs7Oy8wLzwvNS8vLy8vLzUvLzYvOy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL//AABEIABQAGAMBIgACEQEDEQH/xAAbAAACAQUAAAAAAAAAAAAAAAAABAUBAgMGB//EACIQAAIBAgUFAAAAAAAAAAAAAAABAwIEBRMhIjEGERIyUv/EABYBAQEBAAAAAAAAAAAAAAAAAAMAAf/EABoRAAIDAQEAAAAAAAAAAAAAAAACASFBMRH/2gAMAwEAAhEDEQA/AOb1YnHC9WOWuLRyLaxSrAXPVo2iVsOmMunhsyVsyOGGfFI41ufYBq76ZzVqmA6ovllBLWcdDr4NgtYqPD1KgHpYXyRUfIAAhH//2Q==","srcSet":"https://www.datocms-assets.com/77616/1661954484-fpmfs-pt3-collision-profile.png?auto=format\u0026dpr=0.25\u0026max-w=600 106w,https://www.datocms-assets.com/77616/1661954484-fpmfs-pt3-collision-profile.png?auto=format\u0026dpr=0.5\u0026max-w=600 212w,https://www.datocms-assets.com/77616/1661954484-fpmfs-pt3-collision-profile.png?auto=format\u0026dpr=0.75\u0026max-w=600 318w,https://www.datocms-assets.com/77616/1661954484-fpmfs-pt3-collision-profile.png?auto=format\u0026max-w=600 425w","webpSrcSet":"https://www.datocms-assets.com/77616/1661954484-fpmfs-pt3-collision-profile.png?auto=format\u0026dpr=0.25\u0026fm=webp\u0026max-w=600 106w,https://www.datocms-assets.com/77616/1661954484-fpmfs-pt3-collision-profile.png?auto=format\u0026dpr=0.5\u0026fm=webp\u0026max-w=600 212w,https://www.datocms-assets.com/77616/1661954484-fpmfs-pt3-collision-profile.png?auto=format\u0026dpr=0.75\u0026fm=webp\u0026max-w=600 318w,https://www.datocms-assets.com/77616/1661954484-fpmfs-pt3-collision-profile.png?auto=format\u0026fm=webp\u0026max-w=600 425w","sizes":"(max-width: 425px) 100vw, 425px","src":"https://www.datocms-assets.com/77616/1661954484-fpmfs-pt3-collision-profile.png?auto=format\u0026max-w=600","alt":null,"title":null,"width":425,"height":340,"aspectRatio":1.25}}},{"__typename":"WebmRecord","id":"55423364","video":{"title":null,"alt":null,"video":{"muxPlaybackId":"YzJL8DWsYt5qiFfkUBBfV46jwxSMMCjE"}}},{"__typename":"WebmRecord","id":"55423365","video":{"title":null,"alt":null,"video":{"muxPlaybackId":"00Nq87qgzBRE9fTlkNcbAKmogR7M7YMqS"}}},{"__typename":"WebmRecord","id":"55423366","video":{"title":null,"alt":null,"video":{"muxPlaybackId":"6JqjADmYqP7p41x01DX6qyLECXIZMounU"}}}]}},"isPreview":false},"__N_SSG":true},"page":"/tutorial/[slug]","query":{"slug":"character-movement-from-scratch-pt-3-collision"},"buildId":"FdMC6e8Jf18CHKkiz_cXU","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>